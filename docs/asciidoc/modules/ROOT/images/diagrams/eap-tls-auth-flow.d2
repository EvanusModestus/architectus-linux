# 802.1X EAP-TLS Authentication Flow

direction: down

# Actors row
actors: {
  direction: right

  supplicant: Supplicant {
    shape: rectangle
    style: {
      fill: "#1565c0"
      font-color: white
      bold: true
      border-radius: 4
    }
  }

  authenticator: Authenticator {
    shape: rectangle
    style: {
      fill: "#e65100"
      font-color: white
      bold: true
      border-radius: 4
    }
  }

  radius: RADIUS Server {
    shape: rectangle
    style: {
      fill: "#7b1fa2"
      font-color: white
      bold: true
      border-radius: 4
    }
  }
}

# Sequence steps
s1: "1. EAPOL-Start" {
  style: {
    fill: "#e3f2fd"
    border-radius: 4
  }
}

s2: "2. EAP-Request/Identity" {
  style: {
    fill: "#fff3e0"
    border-radius: 4
  }
}

s3: "3. EAP-Response/Identity" {
  style: {
    fill: "#e3f2fd"
    border-radius: 4
  }
}

s4: "4. RADIUS Access-Request" {
  style: {
    fill: "#fff3e0"
    border-radius: 4
  }
}

s5: "5. TLS Handshake + Certs" {
  style: {
    fill: "#f3e5f5"
    border-radius: 4
  }
}

s6: "6. Access-Accept + VLAN" {
  style: {
    fill: "#c8e6c9"
    border-radius: 4
  }
}

s7: "7. EAP-Success" {
  style: {
    fill: "#c8e6c9"
    border-radius: 4
  }
}

# Result
result: Port Authorized {
  shape: rectangle
  style: {
    fill: "#2e7d32"
    font-color: white
    bold: true
    border-radius: 4
  }
}

# Flow
actors -> s1
s1 -> s2
s2 -> s3
s3 -> s4
s4 -> s5
s5 -> s6
s6 -> s7
s7 -> result

# Legend
legend: {
  direction: right

  l1: Supplicant {
    style: {
      fill: "#e3f2fd"
      border-radius: 4
    }
  }
  l2: Authenticator {
    style: {
      fill: "#fff3e0"
      border-radius: 4
    }
  }
  l3: RADIUS {
    style: {
      fill: "#f3e5f5"
      border-radius: 4
    }
  }
  l4: Success {
    style: {
      fill: "#c8e6c9"
      border-radius: 4
    }
  }
}
