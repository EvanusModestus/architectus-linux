# EAP-TLS Certificate Chain

direction: down

# PKI Hierarchy - clean vertical flow
root: Root CA {
  shape: rectangle
  style: {
    fill: "#c62828"
    font-color: white
    bold: true
    border-radius: 4
  }
}

intermediate: Intermediate CA {
  shape: rectangle
  style: {
    fill: "#f9a825"
    font-color: white
    bold: true
    border-radius: 4
  }
}

# Endpoint certs side by side
certs: {
  direction: right
  style: {
    fill: transparent
    stroke: transparent
  }

  server: Server Cert {
    shape: rectangle
    style: {
      fill: "#388e3c"
      font-color: white
      bold: true
      border-radius: 4
    }
  }

  client: Client Cert {
    shape: rectangle
    style: {
      fill: "#388e3c"
      font-color: white
      bold: true
      border-radius: 4
    }
  }
}

# Signing chain
root -> intermediate: "Signs" {
  style: {
    stroke: "#c62828"
    stroke-width: 2
  }
}

intermediate -> certs: "Issues" {
  style: {
    stroke: "#f9a825"
    stroke-width: 2
  }
}

# Trust endpoints side by side
endpoints: {
  direction: right
  style: {
    fill: transparent
    stroke: transparent
  }

  ise: RADIUS Server {
    shape: rectangle
    style: {
      fill: "#7b1fa2"
      font-color: white
      bold: true
      border-radius: 4
    }
  }

  linux: Linux Client {
    shape: rectangle
    style: {
      fill: "#1565c0"
      font-color: white
      bold: true
      border-radius: 4
    }
  }
}

# Install relationships
certs.server -> endpoints.ise: "Installed" {
  style: {
    stroke: "#7b1fa2"
    stroke-dash: 3
  }
}

certs.client -> endpoints.linux: "Installed" {
  style: {
    stroke: "#1565c0"
    stroke-dash: 3
  }
}

# Mutual auth
mutual: Mutual TLS Authentication {
  shape: rectangle
  style: {
    fill: "#0d47a1"
    font-color: white
    bold: true
    border-radius: 4
  }
}

endpoints -> mutual: "Both validate chain" {
  style: {
    stroke: "#0d47a1"
    stroke-width: 2
  }
}

# EKU annotations
eku: {
  direction: right
  style: {
    fill: transparent
    stroke: transparent
  }

  server_eku: "id-kp-serverAuth" {
    shape: text
    style: { font-size: 10; italic: true; font-color: "#388e3c" }
  }

  client_eku: "id-kp-clientAuth" {
    shape: text
    style: { font-size: 10; italic: true; font-color: "#388e3c" }
  }
}
